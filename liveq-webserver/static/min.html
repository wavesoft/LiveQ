<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Minimal test</title>
		<script type="text/javascript" src="lib/d3.v3.min.js"></script>
		<script type="text/javascript" src="lab.js.src/LiveQ.js"></script>
		<script type="text/javascript" src="lab.js.src/BufferReader.js"></script>
		<script type="text/javascript" src="lab.js.src/HistogramData.js"></script>
		<script type="text/javascript" src="lab.js.src/ReferenceData.js"></script>
		<script type="text/javascript" src="lab.js.src/HistogramReader.js"></script>
		<script type="text/javascript" src="lab.js.src/LabSocket.js"></script>
		<script type="text/javascript" src="lab.js.src/Plot.js"></script>
		<script type="text/javascript" src="lab.js.src/PlotHistogram.js"></script>
		<style type="text/css">

		body {
		  font: 10px sans-serif;
		}

		.axis path,
		.axis line {
			fill: none;
			stroke: #000;
			shape-rendering: crispEdges;
		}

		path.plot-line {
			fill: none;
		}
		path.plot-area {
			stroke: none;
		}
		path.plot-bullet {
			fill: #fff;
		}

		svg {
			background: #efefef;
		}

		</style>
		<script type="text/javascript">

		// #################################################################################
		// =================================================================================
		//                                  DEMO LAB
		// =================================================================================
		// #################################################################################

		function ExampleLab() {

			// Establish connection to the lab
			this.lab = new LiveQ.LabSocket("3e63661c13854de7a9bdeed71be16bb9");

			// Register handlers for new histograms
			this.lab.onHistogramAdded(function(histo, ref) {

				// Create a new plot and store it in the histogram object
				histo.plot = new LiveQ.PlotWindow("#host", {
						'width': 400,
						'height': 300,
						'imgTitle': ref.imgTitle,
						'imgXLabel': ref.imgXLabel,
						'imgYLabel': ref.imgYLabel
					});

				// Place the reference data
				histo.plot.addHistogram( ref.reference, "Reference data" )

				// Place histogram
				histo.plot.addHistogram( histo, ref.name );

			});

			// Redraw histogram when updated
			this.lab.onHistogramUpdate(function(histo, ref) {

				// Update plot
				histo.plot.update();

			});

			this.begin = function() {
				this.lab.beginSimulation({
					'TimeShower:alphaSvalue': 0.1
				});
			}

			this.cancel = function() {
				this.lab.abortSimulation();
			}
		}


		// #################################################################################
		// =================================================================================
		//                               UTILITY FUNCTIONS
		// =================================================================================
		// #################################################################################

		function mkdata() {
			var data=[], max=100;
			for (var i=0; i<max; i++) {
				data.push([i*2, Math.random()*max*2]);
			}
			return data;
		}

		function str2ab(str) {
		  var buf = new ArrayBuffer(str.length); // 2 bytes for each char
		  var bufView = new Uint8Array(buf);
		  for (var i=0, strLen=str.length; i<strLen; i++) {
			bufView[i] = str.charCodeAt(i);
		  }
		  return buf;
		}

		function buf64(b64) {
			return str2ab(atob(b64));
		}

		function histoFromBuf(name) {
			var buf = buf64(srcBuf),
				bufReader = new LiveQ.BufferReader(buf);

			var histo = new LiveQ.HistogramData();
			histo.updateFromReader(bufReader);
			if (name) histo.id = name;
			return histo;
		}

		var srcBuf = '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';
		</script>
	</head>
	<body>
		<div id="host"></div>
	</body>
</html>